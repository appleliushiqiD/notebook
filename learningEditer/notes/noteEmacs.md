# 笔记：Emacs 编辑器

***查看中文指南 `M-x help-with-tutorial-spec-language` / `C-u C-h t`***

### 编辑器基础

- 页面  
  - 回显区 Echo area : 命令提示  
  - 状态栏 Mode line : 回显区上方一行  

- 状态栏 Mode line
  - 样式：`-:**- buffer position lineNum (Fundamental)`  
  - `**` : 表示内容被更改过，没有更改显示为 `--`  
  - `buffer` : 缓冲区名  
  - `position` : 光标所在全文中的位置，分别有 `Top` / `persent%` / `Bot` / `All`  
  - `lineNum` : 以 `L?` 显示光标所在行  
  - `(Fundamental)` : 当前缓冲区使用的**编辑模式**

- 编辑模式
  - 主模式 major ：一个缓冲区只有一个主模式  
  - 辅模式 minor ：一个缓冲区可以没有辅模式，或者一个或多个辅模式  

### 命令基础

- 基础  
  - `C-c`: 按住 `Ctrl` 同时按住 `c` 
  - `C-c x`:  使用 `Ctrl-c` 后按 `x`  

- 命令集拓展  
  - `C-x` : 字符拓展，命令后键入另一个字符或组合键  
  - `M-x` : 命令名拓展，命令后键入一个命令名  

- 程序  
  - `C-z` : 挂起 Emacs  
  - `C-x C-c` : 退出 Emacs  

#### `C`==`Ctrl`  

- `C-x C-c` : 退出 Emacs  
- `C-g` : 中断输入执行的命令或输入中的命令  
  - 退出 `Esc` 代替 `M-` 命令时，请连续按击 `Esc` 两次（ `Esc C-g` == `M-C-g` ）  
- `C-u ? <op>` : 重复命令 <op> ？次  
  - 对于 `C-v` / `M-v` 向下向上移动 `?` 行  
  - 对于 `C-l` 光标行移动到窗口第 ? 行  
  - 文本编辑内容会重复 ? 次  
- `C-x 1` : 只保留一个窗口（光标所在窗口）  

#### `M` == `Meta` / `Alt` / `Edit`  

- `M-c` == `Esc c` 

#### 光标移动

- 翻页（并不移动光标，光标会自动显示到当前页面内容中）  
  `C-v`: 下翻页，屏幕内容为一页  
  `M-v`: 上翻页，屏幕内容为一页  
  `C-l`: 重绘屏幕，光标所在行移动至屏幕中央，两次键入光标行移到屏幕首行  
- 上下左右  
  `C-p/n/b/f` ( previous/next/backward/forward )  
- 词句  
  `M-b/f` 光标向前 / 向后移动一个词的量  
  `M-a/e` 光标移动到句首 / 句尾  
- 行间  
  `C-a/e` 光标移动到行首 / 行尾  
- 内容  
  `M-</>` 光标移动到所有文字最开头 / 最末尾（ `<` 使用 `shift` 写出） == `M-shift-,/.`


#### 编辑内容

- 删除 `DEL` == `Backspace`
  - `DEL` : 删除光标前的一个字符  
  - `C-d` : 删除光标后的一个字符，同键 `Delete`  
  - `M-<DEL>` : 移除光标前的一个词  
  - `M-d` : 移除光标后的一个词  
  - `C-k` : 移除光标到行尾的字符  
  - `M-k` : 移除光标到句尾的字符  
- 删除（ delete ）和移除（ kill ）  
  - 移除：内容会被 Emacs 记录，并可以找回，重新插入移除的内容称为召回（ yank ），但一些空白内容或单字符不会被保存  
  - 删除：内容被 Emacs 抛弃，不能被找回，可能还在内存，撤销删除命令可以找回内容，`DEL` 和 `C-d` 有前缀参数改为移除  
- 选中删除  
  `C-<SPC>` == `C-@` 后移动光标 `C-w` : 移除选择的内容  
- 剪切与复制（没有在指南中提及）  
  - `C-w` : 剪切内容  
  - `M-w` : 复制内容  
- 召回（或粘贴）  
  - `C-y` : 召回最后移除的内容  
  - `M-y` : 召回前一次移除的内容，在 `C-y` 后使用，可以连续前翻移除的内容（会更换召回的内容，即只有一次的移除内容被召回在光标处）  
- 撤销 undo  
  - `C-/` : 消除一个命令造成的改变  
  - 例外，没有改变内容的命令不算  
  - `C-/` == `C-_` / `C-x u`  
- 替换 replace  
  - `M-x repl s` : `Return` 被替换的内容 `Return` 替换的内容  

#### 文件

- 文件  
  - `C-x C-f` : 命令后键入要查找的文件名，当文件不存在时创建文件  
  - `C-x C-s` : 存盘，保存缓冲区到文件  
  - 
- 缓冲区 buffers  
  - `C-x C-f` : 会新开缓冲区  
  - `C-x C-b` : 列出缓冲区  
  - `C-x b` : 切换缓冲区，命令后键入目标缓冲区（如文件名）  
  - `C-x s` : 保存所有缓冲区  
- 自动保存  
  - Emacs 会自动为编辑中的文件创建自动保存文件，以 `#<filename>#` 为名  
  - `M-x recover file` : 从自动保存文件中恢复内容  
  - 自动保存文件在正常存盘后被删除  

#### 编辑模式

- 切换编辑模式
  - `M-x` : 命令后键入模式名  
  - `C-h m` : 查看当前缓冲区主模式的文档  


#### 搜索

- `C-s` : 向前搜索  
- `C-r` : 向后搜索  
- Emacs 搜索命令是渐进式的，输入时就开始搜索  
- 输入搜索内容后，使用同一搜索命令查找下一个，回溯使用`DEL`  
- 使用 `Return` 结束搜索  

#### 窗格与窗口

- 窗格 windows  
  - `C-x 2/3` : 当前窗格划分为上下 / 左右两个窗格  
  - `C-M-v` : 光标所在的其他窗格下翻页  
  - `C-M-S-v` : 光标所在的其他窗格上翻页  
  - `C-x o` : 光标移动到其他窗格  
  - `C-x 4 C-f` : 创建新窗格打开新的文件  

- 窗口 frame  
  - 窗口由窗格、菜单、菜单、回显区等组成  
  - `C-x 5 2` : 创建新窗口  
  - `C-x 5 0` : 关闭选中的窗口  

#### 递归编辑

- 递归编辑状态显示在状态栏的编辑模式上，`[(Fundamental)]`  
- [比如在用 M-% 进行交互式替换的时候你又用了 C-s 进行搜索，这时替换模式并没有结束，但你又进入了搜索模式，这就是所谓的递归编辑。]  
- `Esc Esc Esc` : 退出递归编辑  
- `Esc Esc Esc` : 最通用的退出命令，可以关闭多余的窗格，离开小缓冲区（取消命令）
- 不能使用 `C-g` 取消递归，仅取消本层递归编辑之内的命令  

### 获取帮助

- `C-h` : 帮助命令，（如果你按 C-h 之后没有任何帮助信息显示出来，那么试试 F1 键或者 M-x help <Return> 。）  
- `C-h ?` : Emacs 的帮助列表  
- `C-h c` : 命令的简要说明，给出命令的函数名  
- `C-h k` : 新开窗格以显示命令函数名称及其文档  
- `C-h x` : 解释一个命令，输入命令名（非组合键），给出有关命令函数实现的信息  
- `C-h v` : 用来显示 Emacs 变量的文档。Emacs 变量可以被用来“定制 Emacs 的行为”  
- `C-h a` : 相关命令搜索，显示包含关键词的命令名，使用 `M-x` 来启动  
- `C-h i/r` : 阅读线上使用手册，进入特殊缓冲区 `*info*` ，可以阅读安装在你系统中的软件套件的线上使用指南  
  - `m emacs` : 阅读 Emacs 使用手册，**完成基础内容学习后，以该指南为参考文件**  
  - `?` : 进入 `info` 模式功能的使用指南  

### 更多功能

- 自动补全 Completion : 节省不必要的键入，使用 `TAB` 补全命令名和文件名  
- 目录编辑 Dired : 参考 Emacs 指南  

#### 软件包

- `M-x list-packages` : 浏览所有可安装的软件包  
  - 打开的界面可以安装和卸载软件包，以及查看软件包的简介  
  - 参考 Emacs 参考指南  

